{"version":3,"file":"index.js","sources":["../../src/client/composables/useGoogleAnalytics.ts"],"sourcesContent":["import type { GoogleAnalyticsPluginOptions } from '../../shared/index.js'\n\ndeclare global {\n  interface Window {\n    dataLayer?: unknown[]\n    gtag?: (...args: unknown[]) => void\n  }\n}\n\n/**\n * Add gtag.js to your site\n *\n * @see https://developers.google.com/analytics/devguides/collection/gtagjs\n * @see https://developers.google.com/analytics/devguides/collection/gtagjs/pages\n * @see https://developers.google.com/analytics/devguides/collection/gtagjs/single-page-applications\n *\n * The enhanced measurement will listen to browser history events (i.e `pushState`, `popState`, and `replaceState`)\n * to collect page_view event, so we do not need to report it manually\n *\n * @see https://support.google.com/analytics/answer/9216061\n */\nexport const useGoogleAnalytics = (\n  options: GoogleAnalyticsPluginOptions,\n): void => {\n  // avoid duplicated import\n  if (window.dataLayer && window.gtag) {\n    return\n  }\n\n  // insert gtag `<script>` tag\n  const gtagScript = document.createElement('script')\n  gtagScript.src = `https://www.googletagmanager.com/gtag/js?id=${options.id}`\n  gtagScript.async = true\n  document.head.appendChild(gtagScript)\n\n  // insert gtag snippet\n  window.dataLayer = window.dataLayer ?? []\n  // the gtag function must use `arguments` object to forward parameters\n  window.gtag = function gtag() {\n    // eslint-disable-next-line prefer-rest-params\n    window.dataLayer!.push(arguments)\n  }\n\n  window.gtag('js', new Date())\n\n  if (options.debug) {\n    window.gtag('config', options.id, { debug_mode: true })\n  } else {\n    window.gtag('config', options.id)\n  }\n}\n"],"names":["useGoogleAnalytics","options","gtagScript"],"mappings":"AAqBO,MAAMA,EACXC,GACS,CAET,GAAI,OAAO,WAAa,OAAO,KAC7B,OAIF,MAAMC,EAAa,SAAS,cAAc,QAAQ,EAClDA,EAAW,IAAM,+CAA+CD,EAAQ,EAAE,GAC1EC,EAAW,MAAQ,GACnB,SAAS,KAAK,YAAYA,CAAU,EAGpC,OAAO,UAAY,OAAO,WAAa,CAAA,EAEvC,OAAO,KAAO,UAAgB,CAE5B,OAAO,UAAW,KAAK,SAAS,CAClC,EAEA,OAAO,KAAK,KAAM,IAAI,IAAM,EAExBD,EAAQ,MACV,OAAO,KAAK,SAAUA,EAAQ,GAAI,CAAE,WAAY,EAAK,CAAC,EAEtD,OAAO,KAAK,SAAUA,EAAQ,EAAE,CAEpC"}